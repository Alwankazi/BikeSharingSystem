{% extends 'base.html' %}
{% load static %}
{% block head %}
  <title>View Reservations</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    top.visible_div_id = 'right';
    function toggle_visibility(id) {
      var old_e = document.getElementById(top.visible_div_id);
      var new_e = document.getElementById(id);
      if(old_e) {
        console.log('old', old_e, 'none');
        old_e.style.display = 'none';
      }
      console.log('new', new_e, 'block');
      new_e.style.display = 'block';
      top.visible_div_id = id;
    }

    function leftFun(){
      document.getElementById("left_toggle_btn").classList.add('clicked_btn');
      document.getElementById("left_toggle_btn").classList.remove('not_clicked_btn');
      document.getElementById("right_toggle_btn").classList.remove('clicked_btn');
      document.getElementById("right_toggle_btn").classList.add('not_clicked_btn');
     }

    function rightFun(){
      document.getElementById("right_toggle_btn").classList.add('clicked_btn');
      document.getElementById("right_toggle_btn").classList.remove('not_clicked_btn');
      document.getElementById("left_toggle_btn").classList.remove('clicked_btn');
      document.getElementById("left_toggle_btn").classList.add('not_clicked_btn');
    }

    function editDetails(elem){
            //var ID = $(this).parent().parent().attr('id');
            //var ID = elem.parentNode.id.slice(5);
            //var e = document.getElementById(ID);
          //  e.classList.add( "canceledElem");

           /////  $(e).find("button").prop("disabled", true);
    }

    $(document).ready(function(){
      $('[data-toggle="popover"]').popover();
    });
</script>

<script type="text/javascript">
  //------------------------------------------------------------------------
  var reser;
  $(document).ready(function(){
  $(".myBtnEdit").click(function(){
    $("#myEditModal").modal();
      reser=this.name;
      $('#currentpickuptime').text($('#stt'+reser).text());
      $('#currentdropofftime').text($('#ent'+reser).text());
      $('#currentcost').text($('#cos'+reser).text());
      $('#currentstartstation').text($('#st'+reser).text());
      $('#currentendstation').text($('#en'+reser).text());
      var select = $('#currentstarttime');
      select.empty().append($('<option disabled selected value>'+'Change pick up time'+'</option>'));
      select.append($('<option></option>')
          .attr('value', 6)
          .text(':'+' ' ));
      select.append($('<option></option>')
              .attr('value', 5)
              .text('dfgdf:'+' ' ));
      //Disable end time
      document.getElementById('currentendtime').selectedIndex=0;
      document.getElementById('currentendtime').style.color= "grey" ;
      document.getElementById('currentendtime').disabled = true;

      //Disable confirm
      document.getElementById('myBtnSubmitChanges').style.display="none";
        });
});
//--------------------------------------------------------------
</script>


<script type="text/javascript">
  var cancelreser;
    var reportreser;
    var payfinereser;
  $(document).ready(function(){
  $(".myBtnCancel").click(function(){
   var ID = $(this).parent().parent().attr('id');
     $("#myCancelationModal .modal-body ").attr( "id", "modal"+ID);
     $("#myCancelationModal").modal();
     cancelreser=this.name;
  });
  $(".myBtnFine").click(function(){
   var ID = $(this).parent().parent().attr('id');
     $("#myFineModal .modal-body ").attr( "id", "modal"+ID);
     $("#myFineModal").modal();
     payfinereser=this.name.split(' ')[1];
     $('#finecost').text(this.name.split(' ')[0]);
     //<!------------HERE I CHANGED -->
     $('#finereason').text(this.name.split(' ').slice(2).join(' '));
     //<!------------HERE I CHANGED -->
  });
});
</script>

<script type="text/javascript">
  var feedbackreservation;
  $(document).ready(function(){
  $(".myBtnFeedback").click(function(){
   var ID = $(this).parent().parent().attr('id');
    feedbackreservation=this.name;
$("#whichtrip").text(feedbackreservation);
     $("#myFeedbackModal .modal-body ").attr( "id", "modal"+ID);

     $("#myFeedbackModal").modal();

  });
  $(".myBtnReport").click(function(){
    reportreser=this.name;
   var ID = $(this).parent().parent().attr('id');
     $("#myReportModal .modal-body ").attr( "id", "modal"+ID);
     $("#myReportModal").modal();
  });
});
  function cancelReservation(elem){
        //var ID = $(this).parent().parent().attr('id');
        //  var ID = elem.parentNode.id.slice(5);
        //var e = document.getElementById(ID);
        //e.classList.add( "canceledElem");
        // $(e).find("button").prop("disabled", true);
         event.preventDefault();
         cancel_reser();
       }
       function payReservation(elem){
             //var ID = $(this).parent().parent().attr('id');
             //  var ID = elem.parentNode.id.slice(5);
             //var e = document.getElementById(ID);
             //e.classList.add( "canceledElem");
             // $(e).find("button").prop("disabled", true);
              event.preventDefault();
              fine_reser();
            }
  var feedbacktext;
  var ratingnumber;
  function sendFeedback(elem){
        //var ID = $(this).parent().parent().attr('id');
        //  var ID = elem.parentNode.parentNode.id.slice(5);
        //var e = document.getElementById(ID);
        //var btn = $(e).find("button");
        //$(btn).prop("disabled", true);
        //$(btn).html("Feedback sent");
        feedbacktext=document.getElementById("customerfeedback").value;
        ratingnumber=document.getElementById("customerrating").value;
        event.preventDefault();
        feedback_reser();
       }
       var report;
       function sendReport(elem){
             //var ID = $(this).parent().parent().attr('id');
             //  var ID = elem.parentNode.parentNode.id.slice(5);
             //var e = document.getElementById(ID);
             //var btn = $(e).find("button");
             //$(btn).prop("disabled", true);
             //$(btn).html("Feedback sent");


             report=document.getElementById("customerreport").value;
             event.preventDefault();
             report_reser();
            }
  $(document).ready(function(){
    $("#myBtnSubmitChanges").click(function(){
    $("#myInformationModal").modal();
  });
});
</script>


  <style>
  table{
    border-radius:6px;
    table-layout: fixed
  }
  .clicked_btn{
    background: rgba(0, 179, 179, 0.8);
    color: white;

  }
  .not_clicked_btn{
    background: rgba(0, 179, 179, 0.3);
     transition: 0.3s;
      color: white;

  }

  .toggle_btn{
     border-bottom: solid white 2px;
     width:100%;
     border-top-left-radius: 15px;
     border-top-right-radius: 15px;

  }
  .not_clicked_btn:hover{
    background:white;
    opacity: 1;
    color:black;
  }
  .toggle_btn:active{
      background:rgba(57, 161, 252, 0.2);
       color:black;

  }
  .alert{
    position: absolute; top: 70px; left: 10px; z-index: 99;right:10px;
  }
  .footer{
    height:80px;
    background-color:#3d3a3a;
    z-index: 5;
    position: absolute;
    bottom: 0;
    width: 100%;
    margin: 0 auto;
    display: none;
    padding:15px;
    display:none;
    border-top-left-radius:5px;
    border-top-right-radius:5px;
  }
  .footer-4{
    height:100%;
    width:100%;
    background-color:#3d3a3a;
    display:flex;
  }
  * {
  box-sizing: border-box
  }

  .closed{
  width:5%;
  height:100%;
  float:left;
  }

  .bod,.header,.dia,.modal-content
  {
    background-color: lightgrey;
    color: #3dcacd;
    border-radius:5px;
  }
  .tit{
    font-size: 15px;
    font-weight:bold;
    border-bottom:2px solid;
    border-top:2px solid;
    margin-bottom:4px;
  }
  .contented{
    display:flex;
  }
  .modal-contents{
    display:flex;
    -moz-box-shadow:    0px 0px 4px 3px #3dcacd;
 -webkit-box-shadow: 0px 0px 4px 3px #3dcacd;
 box-shadow:         0px 0px 4px 3px #3dcacd;
  }
  .column-4, .column-8 {
    float: left;
    position: relative;

  }
  .column-4 {
    width: 36%;
    border: 1px solid;
    border-radius:10px;
  }
  .column-8 {
    width: 70%;
    text-align:right;

  }
  .column-1 {
    height: 20%;
    width:100%;
    float: left;
    position: relative;
  }
  .col1 {
    height: 80%;
    float: left;
    width:20%;
    position: relative;
  }
  .col2 {
    height: 50%;
    width:70%;
    float: right;
    position: relative;
  }
  .column-2 {
    width:100%;
    height: 80%;
    float: right;
    position: relative;
  }
  .start,.end{
    border:1px solid;
    text-align:center;
    border-radius:5px;
    font-size:12px;
  }
  .start{
    border:1px solid #7CFC00;
    color:	#7CFC00;
    margin-bottom:2px;
  }
  .end{
    border:1px solid #f44336;
    color: #f44336;
    border-color:red;
  }
  .priority{
    font-size:10px;
  }
  .list-group-item{
    background-color: lightgrey;
    border-style:none!important;
    color:black;
  }
  .information
  {
    font-weight:bold;
    font-size:12px;
  }
  .styled-select select {
  background: transparent;
  border: none;
  font-size: 14px;
  height: 29px;
  padding: 15px; /* If you add too much padding here, the options won't show in IE */
  width: 268px;
  }
  .num1{
    background-color:white;
    position:relative;
  }
  .dx{
    font-size:15px;
    font-weight:bold;
    float:right;
    width:70%;
    height:50%;
    position: relative;
  }
  .cont{
    display:block;
  }
  .titles{
    font-size:20px;
    font-weight:bold;
  }
  .cq,.cm,.av,.qu{
   border: 1px solid #3dcacd;
   padding:2px;
   border-radius:4px;
    height:100%;
    width:50%;
    float:left;
  }
  .context{
    font-size:15px;
  }
  .ci{
   font-size:10px;
   padding:4px;
  }
  .rounded {
  -webkit-border-radius: 15px;
  -moz-border-radius: 15px;
  border-radius: 15px;
  }
  .time{
  text-align:center;
  }
  .bike{
  color: #3dcacd;
  text-align:left;
  font-size:15px;
  }
  .black   { background-color: #3dcacd; }
  #myTab a, a:active, a:visited{border:1px solid #3dcacd;box-shadow: 2px 2px 1px grey;}
  #myTab a:hover {color:  #3d3a3a; background-color: #3dcacd;border:1px solid  #AFABAA;
    border-radius:3px; }
  #myTab a:focus{ color:  #3d3a3a; background-color: #3dcacd;border:1px solid  #AFABAA;
    border-radius:3px; }
    .links{ color:  #3d3a3a; background-color: #3dcacd;border:1px solid  #AFABAA;
      border-radius:3px;box-shadow: 2px 2px 1px grey;

    }
    .button-3 {border-radius: 8px; color:  #3d3a3a; background-color: #3dcacd; margin-left:2px;}


  .centered_item{
      display:flex;
      justify-content:center;
      align-items:center;
      color: black;

    }

  .table_style{
    border-right-color: grey;
    border-right-style: solid;
    border-right-width: 1px;
    border-left-color: grey;
    border-left-style: solid;
    border-left-width: 1px;
    border-bottom-color: grey;
    border-bottom-style: solid;
    border-bottom-width: 1px;
    border-top-color: white;
    border-top-style:solid;
     border-top-width: 2px;
    width:100%;
    border-top-left-radius: 15px;
     border-top-right-radius: 15px;
     background-color:#3d3a3a;
  }
.canceledElem{
 background-color: red;
 opacity: 1;
}
.costq,.costm,.av,.qu{
 border: 1px solid #3dcacd;
 padding:2px;
 border-radius:4px;
  height:100%;
  width:50%;
  float:left;
}


.modal-content{
  background-color:#3d3a3a;
}
td{
  background: rgba(204, 204, 204, 0.9);
}
  thead{
     background:darkgrey;
  }
.btn{
 margin: 2px;
}
.btn:hover{
transition:0.3s;

}




.warning p {
    font: small-caps bold 1.2rem sans-serif;
    text-align: center;
}


 </style>

{% endblock %}
{% block body %}
<div class="container" >

    <h2>Hey there! </h2>
    <h4>Below you can find all the information about you future and past reservations. </h4>


<body onload="toggle_visibility('left');">
  {% if ongoing %}

<div class=" centered_item toggle_btn clicked_btn" >
<center>  <h3 style="color:white;">Ongoing</h3></center>

</div>
<!---new version -->


<div class='centered_item table-responsive'>

  <table style="">
{% for record in ongoing %}
       <tr style="border-top:5px solid #3d3a3a;">
        <td style=" background-color:#3d3a3a;color:white;" colspan="2">
         <h4>RESERVATION: {{ record.res_code }}</h4>
        </td>
       </tr>
       <tr>
         <td style="font-size:15px;border-radius:2px;" colspan='2'>

            Start Station:
            <span style="color: #009688;" id='st{{ record.reservation_id }}'>
              {{ record.startname }}
            </span>
             at
             <span style="color: #009688;" id='stt{{ record.reservation_id }}'>
                {{ record.starttime }}
            </span>


            </td>
<!--------------
              <form action="/home/reservations/" method="POST" name="time-edit" class="timeedit">
                <button id='myBtnEdit' type="submit" name='{{ record.reservation_id }}' class="btn btn btn-warning myBtnEdit" style="width:100%;">Edit Time</button></td>
              </form>
      <!---------------->
        </tr>
         <tr class="table-light" >
               <td style="font-size:15px;" colspan='2'>
                End Station:
                 <span style="color: #009688;"id='en{{ record.reservation_id }}'>
                    {{ record.endname }}
                  </span>
                  until
                  <span style="color: #009688;"id='ent{{ record.reservation_id }}'>
                    {{ record.endtime }}
                  </span>

                 <br>
              </td>
      </tr>
      <tr>
         <td colspan='2'>
          <table style="width: 100%;" class="table table-hover">
            <tr>
              <th  style="width:80%;">
               <h5 style="font-size:15px;"> Type </h5>
              </th>
              <th  style="width:20%;">
               <h5  style="font-size:15px;"> Count </h5>
              </th>
            </tr>
            <!-- original code
              {% for bike in bikesonreservations %}
              {% if bike.bor_reservation_id == record.reservation_id %}
              <tr>
              <td>
              <img style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black) drop-shadow(-1px -1px 0 white);
                  filter: drop-shadow(1px 1px 0 white) drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}
                  </td>
                  <td >
                    1 piece
                  </td>
            </tr>
              {% endif %}

              {% endfor %}
             end of orginal code -->
              {% for bike in countbiketypereservation %}
              {% if bike.bor_reservation_id == record.reservation_id %}
              <tr>
              <td  style="width:80%;">
              <img style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black) drop-shadow(-1px -1px 0 white);
                  filter: drop-shadow(1px 1px 0 white) drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}
                  </td>
                  <td  style="width:20%; font-size:20px;">
                    {% if bike.count == 1%}
                    {{bike.count}}
                    {% else %}
                    {{bike.count}}

                    {% endif %}
                  </td>
            </tr>
              {% endif %}

              {% endfor %}
            </table>
      </td>
       </tr>
        <tr>
           <td colspan='2'>

            RESERVED ON:<span style="color: #009688;"> {{ record.res_date }}</span>
            <br>
            PAID: <span style="color: #009688;"id="cos{{ record.reservation_id }}" >{{ record.res_cost }}</span>
          </td>

         </tr>
         <tr style="margin-top: 2%;">
          <td style="color:black;width: 50%;">
      </td>
     <td><button  type="button" class="btn btn-danger modals myBtnReport" name='{{ record.res_code }}' style="width:80%;">Report Issue</button> </td>
       </tr>

         <!--    {% if now.date < record.starttime.date %}
                     <button type="button" name='{{ record.reservation_id }}' class="btn btn-danger myBtnCancel"  style="width:20%;">Cancel</button>
              {% endif %}-->

{% endfor %}

    </table>
</div>


<!--
</div> -->


  {% endif %}
  <br>

<!-- toggle buttons -->
<div class='centered_item'>
<div onclick="toggle_visibility('left');leftFun();" class="toggle_btn clicked_btn" id= 'left_toggle_btn'>
<center>  <h3>Past</h3></center>

</div>

<div onclick="toggle_visibility('right'); rightFun();" class='toggle_btn  not_clicked_btn ' id='right_toggle_btn' >
 <center><h3>Future</h3></center>
</div>
</div>
<!-- The table starts -->
 <div class='centered_item table-responsive'>
     <div id="left" class="table_style">

  <table class="table table-hover">
    <tbody>
         {% for record in pastreservations %}
         <tr style="border-top:5px solid #3d3a3a;"><td style=" background-color:#3d3a3a;color:white;"><h4>RESERVATION: {{ record.res_code }}</h4></td>
         </tr>
          <tr>
         <td style="font-size:15px;border-radius:2px;" colspan='2'>

            Start Station:
            <span style="color: #009688;" id='st{{ record.reservation_id }}'>
              {{ record.startname }}
            </span>
             at
             <span style="color: #009688;" id='stt{{ record.reservation_id }}'>
                {{ record.starttime }}
            </span>


            </td>
<!--------------
              <form action="/home/reservations/" method="POST" name="time-edit" class="timeedit">
                <button id='myBtnEdit' type="submit" name='{{ record.reservation_id }}' class="btn btn btn-warning myBtnEdit" style="width:100%;">Edit Time</button></td>
              </form>
      <!---------------->
        </tr>
         <tr class="table-light" >
               <td style="font-size:15px;" colspan='2'>
                End Station:
                 <span style="color: #009688;"id='en{{ record.reservation_id }}'>
                    {{ record.endname }}
                  </span>
                  until
                  <span style="color: #009688;"id='ent{{ record.reservation_id }}'>
                    {{ record.endtime }}
                  </span>

                 <br>
              </td>
      </tr>
        <tr > <td colspan="2">
       <!--   {% for bike in bikesonreservations %}
          {% if bike.bor_reservation_id == record.reservation_id %}
        <img style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black)
              drop-shadow(-1px -1px 0 white);
              filter: drop-shadow(1px 1px 0 white)
              drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}<br>
          {% endif %}
            {% endfor %}--><table style="width: 100%;" class="table table-hover">
            <tr>
              <th  style="width:80%;">
               <h5 style="font-size:15px;"> Type </h5>
              </th>
              <th  style="width:20%;" >
               <h5  style="font-size:15px;"> Count </h5>
              </th>
            </tr>
            {% for bike in countbiketypereservation %}
              {% if bike.bor_reservation_id == record.reservation_id %}
              <tr>
              <td  style="width:80%;">
              <img style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black) drop-shadow(-1px -1px 0 white);
                  filter: drop-shadow(1px 1px 0 white) drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}
                  </td>
                  <td  style="width:20%;font-size:20px;">
                    {% if bike.count == 1%}
                    {{bike.count}}
                    {% else %}
                    {{bike.count}}

                    {% endif %}
                  </td>
            </tr>
              {% endif %}

              {% endfor %}
            </table>

        </td></tr>
        <tr>

           <td>RESERVED ON: {{ record.res_date }}<br>PAID: {{ record.res_cost }}</td>
           <!------------HERE I CHANGED -->
           <td  style="width:100%;">{% if record.c_rating == None %} <button type="button" name='{{ record.res_code }}' style="width:100%;color:black;" class="btn btn-info myBtnFeedback">Send Feedback</button>{% endif %}</td>
           <!------------HERE I CHANGED -->
          </tr>

         <tr>

           <td colspan="2"  style="width:100%;">{% if record.fine_desc != None %}<button type="button" style="width:100%;" name="{{ record.fine_cost }} {{ record.reservation_id }} {{ record.fine_desc }}" class="btn btn-danger myBtnFine">PAY {{ record.fine_cost }} FINE NOW!</button>{% endif %} </td>
          </tr>
            {% endfor %}
    </tbody>
</table>

</div>

 <div id="right"  class='table_style ' >
      <table class="table table-hover">

  <tbody>
          {% for record in futurereservations %}
<tr><td ><table style="width: 100%;">
       <tr style="border-top:5px solid #3d3a3a;">
        <td style=" background-color:#3d3a3a;color:white;" colspan="2">
         <h4>RESERVATION: {{ record.res_code }}</h4>
        </td>
       </tr>
       <tr>
         <td style="font-size:15px;border-radius:2px;" colspan='2'>

            Start Station:<span style="color: #009688;" id='st{{ record.reservation_id }}'>{{ record.startname }}</span>
             at
             <span style="color: #009688;" id='stt{{ record.reservation_id }}'>{{ record.starttime }}</span>


            </td>
<!--------------
              <form action="/home/reservations/" method="POST" name="time-edit" class="timeedit">
                <button id='myBtnEdit' type="submit" name='{{ record.reservation_id }}' class="btn btn btn-warning myBtnEdit" style="width:100%;">Edit Time</button></td>
              </form>
      <!---------------->
        </tr>
         <tr class="table-light" >
               <td style="font-size:15px;" colspan='2'>
                End Station:
                 <span style="color: #009688;"id='en{{ record.reservation_id }}'>{{ record.endname }}</span>
                  until
                  <span style="color: #009688;"id='ent{{ record.reservation_id }}'>{{ record.endtime }}</span>

                 <br>
              </td>
      </tr>
      <tr>
         <td colspan='2'>
          <table style="width: 100%;" class="table table-hover">
            <tr>
              <th style="width:80%;">
               <h5 style="font-size:15px;"> Type </h5>
              </th>
              <th style="width:20%;">
               <h5  style="font-size:15px;"> Count </h5>
              </th>
            </tr>
            <!-- original code
              {% for bike in bikesonreservations %}
              {% if bike.bor_reservation_id == record.reservation_id %}
              <tr>
              <td>
              <img style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black) drop-shadow(-1px -1px 0 white);
                  filter: drop-shadow(1px 1px 0 white) drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}
                  </td>
                  <td >
                    1 piece
                  </td>
            </tr>
              {% endif %}

              {% endfor %}
             end of orginal code -->
              {% for bike in countbiketypereservation %}
              {% if bike.bor_reservation_id == record.reservation_id %}
              <tr>
              <td style="width:80%;">
              <img name="{{ bike.bike_type.bike_type_id }}/{{bike.count}}" class="bikesreserved{{ record.reservation_id }}"style="width:50px;height:50px;-webkit-filter: drop-shadow(1px 1px 0 black) drop-shadow(-1px -1px 0 white);
                  filter: drop-shadow(1px 1px 0 white) drop-shadow(-1px -1px 0 black);" src="{% static 'bikes/'|add:bike.bike_type.bike_image %}">{{ bike.bike_type.bike_type }}
                  </td>
                  <td style="width:20%;font-size:20px">
                    {% if bike.count == 1%}
                    {{bike.count}}
                    {% else %}
                    {{bike.count}}

                    {% endif %}
                  </td>
            </tr>
              {% endif %}

              {% endfor %}
            </table>
      </td>
       </tr>
        <tr>
           <td colspan='2'>

            RESERVED ON:<span style="color: #009688;"> {{ record.res_date }}</span>
            <br>
            PAID: <span style="color: #009688;"id="cos{{ record.reservation_id }}" >{{ record.res_cost }}</span>
          </td>

         </tr>
         <tr style="margin-top: 2%;">
          <td style="text-align: center;">
             <button name='{{ record.reservation_id }}' type="button" class="btn btn-warning edits modalss" style="width:85%; display: inline-block;"data-toggle="modal" data-target="#exampleModal">Edit Reservation</button></td><td style="text-align: center;">
             <button type="button" name='{{ record.reservation_id }}' class="btn btn-danger myBtnCancel"  style="width:80%; display: inline-block;">Cancel</button>
           </td>
         <!--    {% if now.date < record.starttime.date %}
                     <button type="button" name='{{ record.reservation_id }}' class="btn btn-danger myBtnCancel"  style="width:20%;">Cancel</button>
              {% endif %}-->
          </td>
         </tr>
    </table>
  </td>
    </tr>
          {% endfor %}
  </tbody>
</table>

 </div>
  </div>
</div>

<!--EDIT RESERVATION -->
<div class="modal fade" id="exampleModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog dia" role="document">
    <div class="modal-content modal-contents">
      <div class="modal-header header column-4" style="border-radius: 0px;background-color: #3d3a3a; ">
        <button type="button" style="float:left;opacity:9; color:#3dcacd;" onclick="reset()" id="clickme" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
        </button>
        <br>
        <h5 class="modal-title tit" id="exampleModalLabel" style="font-size: 17px; " >Reservation Details</h5>
        <div style="margin-top: 1%;">

          Start Station <br><div class="start" id="startloc" style="height: 20%; font-size: 17px;" ></div>
          End Station <br><div class="end" id="endloc"  style="height: 20%; font-size: 17px;" ></div><br>
          <p class="information" style="font-size: 17px; text-decoration: none;" id="startinfo"></p>
          <p class="information" id="endinfo" style="font-size: 17px; text-decoration: none;"></p>




        </div>
        <br>
        <table style="width:100%;">
          <tr style="border-bottom: 2px solid; ">
            <th>Calculated Cost</th>
          </tr>
          <tr>
            <td style="background-color:#3d3a3a;border-bottom:1px solid;width:10%;">Time €<span style="text-align:left;" id="cost">0</span></td>
          </tr>
          <tr>
            <td style="background-color:#3d3a3a;border-bottom:1px solid;">Bike&nbsp;&nbsp;&nbsp;€<span style="text-align:left;" id="cyclecost">0</span></td>
          </tr>
          <tr>
            <td style="background-color:#3d3a3a;">Total  €<span style="text-align:left;" id="totalcost">0</span></td>
          </tr>
        </table>
          <ul class="nav nav-tabs nav-justified"  id="myTab" role="tablist">
            <li class="nav-item" style="text-align:center; width: 100%;">
              <a onclick="resetHomeSelect()" class="nav-link active" style="width: 100%;" id="home-tab" data-toggle="tab" href="#home1" role="tab" aria-controls="home1" aria-selected="true">Time</a>
            </li>
            <li class="nav-item">
              <a onclick="resetBikeSelect()" class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false" style="display:none;">Bike</a>
            </li>
          </ul>
      </div>
      <div class="modal-body bod column-8" >
        <div class="tab-content" id="myTabContent">
          <div class="tab-pane fade" id="home1" role="tabpanel" aria-labelledby="home-tab">
            <ul class="list-group" style="color: #3dcacd;">
              <li class="list-group-item time" style="color: #3d3a3a;font-size: 20px;">
              <u>  Select reservation time</u>
              <br>
           <p style="font-size:15px;"> The tarif is <span style="color:#3dcacd;">€5/15min</span> for all bike types</p>

              </li>

               <li class="list-group-item time"  style="color: #3d3a3a;">
                  Start Date:
                 <select class="styled-select "  style="width: 80%;"id="select_start_date">
                 <option disabled selected value>Select Start Date</option>
               </select>
               </li>
               <li class="list-group-item time"  style="color: #3d3a3a;">
                End Date:
                 <select class="styled-select " style="width: 80%;" id="select_end_date">
                   <option disabled selected value>Select End Date</option>
                 </select>
               </li>
               <li class="list-group-item time"  style="color: #3d3a3a;">
                Start Time:
                 <select class="styled-select " style="width: 80%;" id="select_start_time">
                   <option disabled selected value>Select Start Time</option>
                 </select>
               </li>
               <li class="list-group-item time"  style="color: #3d3a3a;">
                End Time:
                 <select class="styled-select " style="width: 80%;" id="select_end_time">
                   <option disabled selected value>Select End Time</option>
                 </select>

               </li>
               <li class="list-group-item" >
                 <form action="/home/reserve/" method="POST" name="time-form" id="timeform">
                      <button id="confirm" onclick="bikeSelect()" type="submit" style="color: black; width: 90%; margin-left: 5%;" class="btn btn-success btn-md">
                        <span>Confirm details</span>
                      </button>
                   </form>
               </li>
               <li class="list-group-item time">
                 <button onclick="resetSelect()" type="button" class="btn btn-default btn-md" style="width:90%;">
                   <span >Reset</span>
                 </button>


               </li>
             </ul>
          </div>              <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <div>
              <ul class="list-group">
                <li class="list-group-item time" id="here"style="color: #3d3a3a;font-size: 20px; text-decoration: none;">
                 <u> Select your bike prefrence</u>
                </li>

                <li class="list-group-item">
                  <div style="display: inline-block; width: 100%; height: 100%;">
                    <div style="height:90%;float: left;">
                      <button onclick="resetSelectBike()" type="button" class="btn btn-default">
                        <span >Reset</span>
                      </button>
                    </div>
                    <div style="float: right;">
                  <form style="" action="/home/reserve/" method="POST" name="bike-form" id="bikeform">
                    <button id="confirm2" onclick="timeSelect()" type="submit"  style="background-color:#4CAF50;border-color:#4CAF50; color: black; margin-top: 2%;" class="btn btn-primary btn-md">
                      <span>Confirm</span>
                    </button>
                  </form>
            </div></div>
                </li>
                {% for bike in bike_type %}
                <li class="list-group-item bike" style="margin-left: 5%;margin-bottom: 0%; margin-top: 0%; padding-bottom: 0%;">
                    <div class="row" style="display:inline-block; width: 100%;">
                        <div class="column-1"  style=" border-top: solid 1px white;float:left; background-color: #3d3a3a; border-top-right-radius: 5px; border-top-left-radius: 5px;">
                          <div >
                              <span id="bike{{ bike.bike_type_id }}" style="  color: white; font-size: 17px; margin-left:2%;"> {{ bike.bike_type }}</span>
                          </div>

                          <div style=" float:right; margin-right: 2%; color: #3d3a3a; margin-left:2%;">

                            <button class="btn btn-success btn-md" style="margin-bottom: 2px;" onclick="removeBike('bike{{ bike.bike_type_id }}')">-</button>
                            <button class="btn btn-success btn-md" style="border-radius: 8px; margin-bottom: 2px; margin-left:2px;" onclick="addBike('bike{{ bike.bike_type_id }}')">+</button>

                          </div>
                        </div>
                        <div class="column-2"  style="color: #3d3a3a; border ;border-bottom-right-radius: 5px;  border-bottom-right-radius: 5px;">
                          <table class="table" style="background-color: white; ">
                            <tr>
                              <td>
                                <div class="av" style="border:none;">Available: <br><span style="color:#3dcacd;" id="available{{ bike.bike_type_id }}">{{ maxbikes }}</span></div>
                              </td>
                               <td>
                                <div class="qu"  style="border:none;">Yours:<br> <span style="color:#3dcacd;" id="quantity{{ bike.bike_type_id }}">0</span></div>

                              </td>

                            </tr>
                            <tr>

                               <td>
                                 <div class="costm"  style="border:none;">Bike: <br>€<span  style="color:#3dcacd;"id="costperfifteen{{ bike.bike_type_id }}">{{ bike.bike_cost }}</span><br>/15min </div>
                              </td>
                              <td>
                                 <div class="costq"  style="border:none;">Rental: <br>€<span style="color:#3dcacd;" id="quantitycost{{ bike.bike_type_id }}">0</span><br>/15min </div>
                              </td>
                            </tr>
                            <tr>
                              <div id='modalBike{{ bike.bike_type_id }}' class='bikeInformation' style="background-color:white"  > <!-- #3d3a3a;-->
                              <div class='bikeInfo' style="color: #3d3a3a; padding-left: 2%; padding-bottom: 2%;padding-top: 2%;  ">
                                  <button type="button btn-success" style='color:black;float:right;border-radius:10px; background-color: #3dcacd;' onclick="displayBikeInfoClose('bike{{ bike.bike_type_id }}')">
                                  <span aria-hidden="true">&times;</span>
                                </button>

                                <img style=" margin-top: 2%; margin-right:2%;float:left;width:90px;height:90px;-webkit-filter: drop-shadow(1px 1px 0 black)
  drop-shadow(-1px -1px 0 white);
  filter: drop-shadow(1px 1px 0 white)
          drop-shadow(-1px -1px 0 white);" src="{% static 'bikes/'|add:bike.bike_image %}">
          <h4 style="font-size: 15px; margin-top: 2%;">Model: {{ bike.bike_model }}</h4>

                                <p style="font-size: 15px;">{{ bike.bike_info }}</p>
                                <br><u style="font-size: 15px; color: #3dcacd;margin-right: 2%;">Cost per fifteen minutes: {{ bike.bike_cost }}</u>

                            </div>
                            </div>
                            </tr><tr>
                            <button type="button"  style="width: 100%;box-shadow: none; " id="button{{ bike.bike_type_id }}" onclick="displayBikeInfo('bike{{ bike.bike_type_id }}')">Learn more</button>
                           </tr>

                          </table>


                        </div>
                    </div>
                </li>
                {% endfor %}

              </ul>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <!-- Button trigger modal -->
  <button id="modalButton1" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal1">
  </button>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal1" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content modal-contents cont" style="color:#3d3a3a;">

        <div class="modal-body context">
          <h5 class="modal-title titles " id="exampleModalLabel1" style="text-align: center; color:white;margin-top: 3%;  font-size:17; ">Would you like to confirm the following reservation?</h5>

          <table style="margin-top: 5%; border: solid 1px white; background-color:lightgrey;border-radius: 10px; width: 100%;">
            <tr >
              <td style="width:50%;">
                 <div class="list-group-item" style="background-color: lightgrey;" >Start Station <br><span  style="font-size: 22px; color: #3dcacd; width: 100%; border-color: #3dcacd;" id="starts"></span></div>

              </td>
              <td style="width:50%;">
                 <div class="list-group-item"style="background-color: lightgrey;" >End Station <br> <span  style="font-size: 22px;  color: #3dcacd; width:100%;border-color: #3dcacd;"  id="ends"></span></div>
             </td>


            </tr>
            <tr>
               <td style="width:50%;">
                 <div class="list-group-item" style="background-color:lightgrey;" >Your reservation will start at<br> <span style="color:#3dcacd;" id="starting"></span><div>

               </td>
               <td style="width:50%;">
                 <div class="list-group-item" style="background-color: lightgrey;">Your reservation will end at <br><span style="color:#3dcacd;" id="ending"></span></div>

               </td>
            </tr>
            <tr>
                <td >
                  <div class="list-group-item"style="background-color:lightgrey;"  id="biked" >Bikes reserved:<br></div>
              </td>
                <td>
                  <table>
                    <tr>
                  <td> <div class="list-group-item" style="background-color: lightgrey;" >Total Hourly cost</div></td><td> €<span id="hourly"></span></td>
                 </tr>
                  <tr><td>
                    <div class="list-group-item"  style="background-color: lightgrey;">Total Bike selected cost</div></td><td> €<span  id="bikebased"></span></td>
                  </tr>
                  <tr>
                    <td>
                    <div class="list-group-item"  style="background-color:lightgrey;" >Final Total cost to pay </div></td><td> €<span  id="finaltotal"></span></td>
                    </tr>
             </table>
                </td>
            </tr>

          </table>

          <div class="list-group-item"  ><h4>In order to avoid fines, kindly arrive at the station in time to unlock your bike.</h4> <h4>Note that you may edit your reservaation up until 1 hour to that start time of the reservation.</h4></div>
          <form  method="post" name="myform">
            {% csrf_token %}
            <input type="hidden" name="inputendstation" id="inputendstation" value=""/>
            <input type="hidden" name="inputstartstation" id="inputstartstation" value=""/>
            <input type="hidden" name="reservation" id="reservationt" value=""/>
            <input type="hidden" name="inputstarttime" id="inputstarttime" value=""/>
            <input type="hidden" name="inputendtime" id="inputendtime" value=""/>
            <input type="hidden" name="inputenddate" id="inputenddate" value=""/>
            <input type="hidden" name="inputstartdate" id="inputstartdate" value=""/>
            <input type="hidden" name="inputtotal" id="inputtotal" value=""/>
            {% for bike in bike_type %}
            <input type="hidden" name="inputbike{{ bike.bike_type_id }}" id="inputbike{{ bike.bike_type_id }}" value="">
            {% endfor %}
            <button type="submit" onclick="send()" style=" width: 100%;"class="btn btn-success">Proceed to Pay</button>
          </form>
        </div>
      </div>
    </div>
  </div>

     <script type="text/javascript">

      function closemodal(){

  /* Single line Reset function executes on click of Reset Button */


  document.getElementById('HiddenButtonID').click();

  }
    </script>
    <!-- The Modal -->
    <div class="modal" id="myFeedbackModal" >
      <div class="modal-dialog">
        <div class="modal-content"style="background-color: lightgrey;" >
          <div class="modal-header" style="border-bottom: 0px; margin-bottom: 0px; padding-bottom: 0px;">
            <button type="button" class="close" onclick="closemodal()" id="closefeedback" >&times;</button>
          </div>
          <div class="centered_item" style=" margin-bottom: 2%;" >
            <div class="modal-body "  style="height: 50%; min-height: 100px;  width: 90%; margin-top: 0px;">
              <h2 style="color:  #3d3a3a; font-weight: bold;"> Feedback Form</h2>
              <h3 style="color: #3d3a3a; "> Thank you for taking your time to comment on our service! Your feedback is very important to us!</h3>
              <h4 style="color:  #3d3a3a;"> You are about to send feedback about the trip with reservation code <span id='whichtrip' style="
             color:rgba(0, 179, 179, 1);"></span>.</h4>
              <div class="input-group " style="width:100%; margin-top:5%;">
                  <form>
                    <input style="visibility: hidden; display: none;" type="button" id="HiddenButtonID" onClick="this.form.reset()" data-dismiss="modal" >


                    <input max="5" min="1"  type="number" class="form-control" id="customerrating" placeholder="Rating of your reservation" required/><br><br><br>
                    <textarea class="form-control"  id="customerfeedback" aria-label="With textarea" placeholder="Feedback or report a bike" style=" margin-bottom: 1%;" required></textarea>
                    <input style='width: 100%;' type='submit' class="btn btn-success" id="myBtnSubmitFeedback" value='Submit' onclick='sendFeedback(this);'/>
                  </form>
              </div>
              <div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
<script>
  document.getElementById('modalButton1').style.display="none";
  var x = 0;
  var startlocationid;
  var endlocationid;
  var startlocationname='';
  var endlocationname='';
  var i=0;
  document.getElementById("confirm2").style.display="none";
  document.getElementById("home-tab").style.display="none";
  const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun","Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
  var startTime;
  var endTime;
  var startDate;
  var endDate;
  var startTime1;
  var endTime1;
  var startDate1;
  var endDate1;
  var bike = {}
    {% for bike in bike_type %}
          bike[Number({{ bike.bike_type_id }})-1] = 0;
          document.getElementById("modalBike"+{{bike.bike_type_id}}).style.display="none";
    {% endfor %}
  var bikesselected=false;
  var timesselected=false;
  var repeat = false;
  var done=0;
  var reservationnumber;
  //------------
  function getOption(sel,text) {
    var opt;
    for ( var i = 0, len = sel.options.length; i < len; i++ ) {
        opt = sel.options[i];
        if ( opt.text ==  text ) {
            sel.selectedIndex=i;
            break;
        }
    }
}
//=-------------------------------
function minutesToString(i)
{
  var hours = Math.floor(i / 60);
  var minutes = i % 60;
  var ampm
  if (minutes < 10){
      minutes = '0' + minutes; // adding leading zero
    }
  ampm = hours % 24 < 12 ? 'AM' : 'PM';
  hours = hours % 12;
  if (hours == 0){
      hours = 12;
    }
  return hours + ':' + minutes + ' ' + ampm;
}
  //------------
  var bikesres=[];
    $('document').ready(function(){
      $(".edits").each(function() {
        var now=new Date();
        now.setHours( now.getHours() + 1 );
        now.setMinutes( now.getMinutes() + 15 );
        var starts=new Date($('#stt'+this.name).text());
        if(now>starts)
        {
          this.style.display="none"
        }
        });
     });
  $(".modalss").click(function() {
    reservationnumber=this.name;
    var slides = document.getElementsByClassName("bikesreserved"+reservationnumber);
    for(var f=0;f<4;f++)
    {
      bikesres[f]=0;
    }

  for(var i = 0; i < slides.length; i++)
  {
     bikesres[Number(slides[i].name.split('/')[0])-1]=Number(slides[i].name.split('/')[1]);
  }
  });
   $('#exampleModal').on('show.bs.modal', function (event) {
       var modal = $(this);
       modal.find('.tit').text('Edit your reservation');
       $('#startloc').text($('#st'+reservationnumber).text());
       $('#endloc').text($('#en'+reservationnumber).text());

       startTime1=formatToStringTime($('#stt'+reservationnumber).text().split(' '));
       endTime1=formatToStringTime($('#ent'+reservationnumber).text().split(' '));
       startDate1=formatToStringDate($('#stt'+reservationnumber).text().split(' '));
       endDate1=formatToStringDate($('#ent'+reservationnumber).text().split(' '));
      // timesselected=true;
      // document.getElementById("confirm").click();
      $('#startinfo').text('Start: '+ startDate1+' '+startTime1);
      $('#endinfo').text('End: '+ endDate1+' '+endTime1);
      document.getElementById("home-tab").click();
   });
   function formatToStringTime(time)
   {
     if(time.length==4)
     {
        if(time[3]=='noon')
        {
          return '12:00 PM';
        }
        else if(time[3]=='midnight')
        {
          return '12:00 AM';
        }
     }
     else if(time.length==5)
     {
       var hours = time[3];
       if(hours.split(":").length==1)
       {
          hours=hours.split(":")[0]+':00';
       }
       if(hours.charAt(0)==='0')
       {
         hours=hours.substr(1);
       }
        return hours+' '+time[4];
     }
   }
   function formatToStringDate(date)
   {
        return date[1].replace(",","")+' '+date[0].replace(".","")+' '+date[2].replace(",","");
   }

  function disable(selector) {
    document.getElementById(selector).selectedIndex=0;
    document.getElementById(selector).style.color= "grey" ;
    document.getElementById(selector).disabled = true;
  }
  function enable(selector) {
        document.getElementById(selector).selectedIndex=0;
        document.getElementById(selector).style.color= "black" ;
        document.getElementById(selector).disabled = false;
  }
  function confirmed()
  {
    $('#exampleModal').fadeOut();
    $("#hourly").text($("#cost").text());
    $("#starts").text($('#startloc').text());
    $("#ends").text($('#endloc').text());
    $("#bikebased").text($("#cyclecost").text());
    $("#finaltotal").text($("#totalcost").text());
    {% for bike in bike_type %}
    if(Number($("#quantity{{ bike.bike_type_id }}").text())!=0){
          $("#biked").append(($("#quantity{{ bike.bike_type_id }}").text())+" of {{ bike.bike_type }}  "+"<br>");}
      {% endfor %}
    $("#ending").text(minutesToString(endTime)+" on "+endDate);
    $("#starting").text(minutesToString(startTime)+" on "+startDate);
    document.getElementById("modalButton1").click();
  }
  function send()
  {
    document.getElementById("exampleModal1").style.display="none";

    document.getElementById("inputstartstation").value=($('#startloc').text());
      document.getElementById("reservationt").value=reservationnumber;
    document.getElementById("inputendstation").value=($('#endloc').text());
                        {% for bike in bike_type %}
    document.getElementById("inputbike{{ bike.bike_type_id }}").value=(bike[Number({{ bike.bike_type_id }})-1]);
                          {% endfor %}
    document.getElementById("inputstarttime").value=minutesToString(Number(startTime));
    document.getElementById("inputendtime").value=minutesToString(Number(endTime));
    document.getElementById("inputstartdate").value=(startDate);
    document.getElementById("inputenddate").value=(endDate);
    document.getElementById("inputtotal").value=($('#totalcost').text());
    document.myform.submit();
  }
  function removeBike(selector) {
         var num = selector[selector.length -1];
         if($('#quantity'+num).text()>0)
          {
            var cost = {{ costperhour }}/4;
             $('#available'+num).text(Number($('#available'+num).text())+1);
              $('#quantity'+num).text(($('#quantity'+num).text())-1);
              if((Number($('#cost').text()))==0)
              {
              $('#quantitycost'+num).text(((Number($('#quantity'+num).text()))*(Number($('#costperfifteen'+num).text()))));
              $('#cyclecost').text(Number($('#cyclecost').text())-(Number($('#costperfifteen'+num).text())));
              }
              else {
              $('#quantitycost'+num).text(((Number($('#quantity'+num).text()))*((Number($('#costperfifteen'+num).text()))*((Number($('#cost').text()))/cost))));
              $('#cyclecost').text(Number($('#cyclecost').text())-(((Number($('#costperfifteen'+num).text()))*((Number($('#cost').text()))/cost))));
              }
              $('#totalcost').text(Number($('#cyclecost').text())+Number($('#cost').text()));

          }
          if(({% for bike in bike_type %}
                (Number($('#quantity{{ bike.bike_type_id }}').text()))+
          {% endfor %}0)==0)
          {
            bikesselected=false;
              document.getElementById("confirm2").style.display="none";
          }
  }
  //--------------------------------------------------------------------
  function displayBikeInfo(selector) {
         var num = selector[selector.length -1];
         document.getElementById("modalBike"+num).style.display="block";
         document.getElementById("button"+num).style.background="grey";
         document.getElementById("button"+num).setAttribute("disabled","disabled");
         document.getElementById("button"+num).style.color="grey";
    //    document.getElementById("id").setAttribute("onclick","displayBikeInfoClose()");
  }
  function displayBikeInfoClose(selector) {
         var num = selector[selector.length -1];
         document.getElementById("modalBike"+num).style.display="none";
          document.getElementById("button"+num).removeAttribute("disabled");
          document.getElementById("button"+num).style.background="#3dcacd";
          document.getElementById("button"+num).style.color="white";
  }
  //-------------------------------------------------------------------
  function addBike(selector) {
    var num = selector[selector.length -1];
    if(Number($('#available'+num).text())>0)
     {
       document.getElementById("confirm2").style.display="block";
       var cost = {{ costperhour }}/4;
       $('#available'+num).text(($('#available'+num).text())-1);
       $('#quantity'+num).text(Number($('#quantity'+num).text())+1);
       if((Number($('#cost').text()))==0)
       {
       $('#quantitycost'+num).text(((Number($('#quantity'+num).text()))*(Number($('#costperfifteen'+num).text()))));
       $('#cyclecost').text(Number($('#cyclecost').text())+(Number($('#costperfifteen'+num).text())));
        }
        else {
       $('#quantitycost'+num).text(((Number($('#quantity'+num).text()))*((Number($('#costperfifteen'+num).text()))*((Number($('#cost').text()))/cost))));
       $('#cyclecost').text(Number($('#cyclecost').text())+(((Number($('#costperfifteen'+num).text()))*((Number($('#cost').text()))/cost))));
      }
     $('#totalcost').text(Number($('#cyclecost').text())+Number($('#cost').text()));
        }
  }
  //https://stackoverflow.com/questions/32890938/next-7-days-in-drop-down-list
  function formatDate(date) {
            var d = new Date(date),
                    day = '' + d.getDate(),
                    month = '' + (d.getMonth() + 1),
                    year = '' +d.getFullYear();
            if (day.length < 2)
                day = '0' + day;
            return [day,monthNames[month-1],year].join(' ');
        }
  function resetSelectBike()
  {
    var qun;
    {% for bike in bike_type %}
         bike[{{ bike.bike_type_id }}] = 0;
      {% endfor %}
      {% for bike in bike_type %}
       qun=Number($('#quantity{{bike.bike_type_id }}').text());
        for(var i=0;i<qun-bikesres[Number({{ bike.bike_type_id }})-1];i++)//CHANGE TO AVAILABLE BIKES
        {
          removeBike('bike{{ bike.bike_type_id }}');
        }
      {% endfor %}

      $('#totalcost').text($('#cos'+reservationnumber).text());
      $('#cyclecost').text(Number($('#totalcost').text())-Number($('#cost').text()));
  }
  function resetSelect(){
    populateDate('#select_start_date','Select Start date',14,new Date); // use selector for your select
    disable("select_end_date");
    disable("select_end_time");
    disable("select_start_time");
    var element = document.getElementById("select_start_date");
    element.value = startDate1;
    $('#select_start_date').change();
    document.getElementById("select_end_date").value = endDate1;
    $('#select_end_date').change();
    getOption(document.getElementById("select_start_time"),startTime1);
    $('#select_start_time').change();
      getOption(document.getElementById("select_end_time"),endTime1);
    $('#select_end_time').change();
    $('#totalcost').text($('#cos'+reservationnumber).text());
    $('#cost').text(Number($('#totalcost').text())-Number($('#cyclecost').text()));
       document.getElementById("confirm").style.display="block";
  }

  function resetHomeSelect(){
    if(timesselected==true)
    {
      resetSelectBike();
      timesselected = false;
      document.getElementById("home-tab").style.display="none";
    }
    else {
      document.getElementById("home-tab").style.display="none";
      populateDate('#select_start_date','Select Start date',14,new Date); // use selector for your select
      disable("select_end_date");
      disable("select_end_time");
      disable("select_start_time");
      var element = document.getElementById("select_start_date");
      element.value = startDate1;
      $('#select_start_date').change();
      document.getElementById("select_end_date").value = endDate1;
      $('#select_end_date').change();
      getOption(document.getElementById("select_start_time"),startTime1);
      $('#select_start_time').change();
        getOption(document.getElementById("select_end_time"),endTime1);
      $('#select_end_time').change();
       if(bikesselected==false || (bikesselected== true && repeat==false))
       {
            resetSelectBike();
           $("#cyclecost").text("0");
       }
       else {
         repeat=false;
          $("#totalcost").text($("#totalcost").text()-(Number($("#cost").text())));
          $("#cost").text("0");
       }
         $('#cyclecost').text(Number($('#totalcost').text())-Number($('#cost').text()));
    }
  }
  function reset() {
    document.getElementById("home-tab").style.display="none";
      startlocationname = "";
      endlocationname="";
      x = 0;
      startlocationid="";
      endlocationid="";
      for(var d=0;d<markerlist.length;d++){
        markerlist[d].setIcon("{% static 'icons/marker.png' %}");
      }
      startTime="";
      endTime="";
      startDate="";
      endDate="";
      $('#startinfo').text("");
      $('#endinfo').text("");
      resetSelect();
      done=0;
      var qun;
      {% for bike in bike_type %}
           bike[Number({{ bike.bike_type_id }})-1] = 0;
        {% endfor %}
        for(var f=0;f<4;f++)
        {
          bikesres[f]=0;
        }
        {% for bike in bike_type %}
         qun=Number($('#quantity{{bike.bike_type_id }}').text());
          for(var i=0;i<qun;i++)//CHANGE TO AVAILABLE BIKES
          {
            removeBike('bike{{ bike.bike_type_id }}');
          }
        {% endfor %}
      $('#cost').text("0");
      $('#cyclecost').text("0");
      $('#totalcost').text("0");
      bikesselected=false;
      timesselected=false;
  }
  function resetBikeSelect(){
      if(timesselected==false)
      {
        //$("#totalcost").text($("#totalcost").text()-(Number($("#cost").text())));
          //$("#cost").text("0");
        //  var x;
          {% for bike in bike_type %}
            $('#quantity{{bike.bike_type_id }}').text(bikesres[Number({{ bike.bike_type_id }})-1]);
            $('#quantitycost{{bike.bike_type_id }}').text(((Number($('#quantity{{bike.bike_type_id }}').text()))*((Number($('#costperfifteen{{bike.bike_type_id }}').text())))));
            {% endfor %}
            $('#home-tab').text("Go back");
            $('#home-tab').css('display','block');
            $('#confirm2').css('display','block');
      }
      else
      {
        var qun;
        {% for bike in bike_type %}
             bike[Number({{ bike.bike_type_id }})-1] = 0;
          {% endfor %}
          {% for bike in bike_type %}
           qun=Number($('#quantity{{bike.bike_type_id }}').text());
            for(var i=0;i<qun;i++)//CHANGE TO AVAILABLE BIKES
            {
              removeBike('bike{{ bike.bike_type_id }}');
            }
          {% endfor %}
        var cost=0;
        var costperfifteen={{ costperhour }}/4;
        st=convertMinutes(startTime);
        et=convertMinutes(endTime);
        if(startDate==endDate)
        {
            for(var i = st; i < et; i += 15){
              cost=costperfifteen+cost;
        }
        }
        else {
          for(var i = st; i < 1440; i += 15){
              cost=costperfifteen+cost;
            }
        for(var i = 0; i < et; i += 15){
            cost=costperfifteen+cost;
          }
        }
        //$('#cost').text(Number(cost));
        $('#totalcost').text($('#cos'+reservationnumber).text());
        $('#cyclecost').text(Number($('#totalcost').text())-Number($('#cost').text()));
        $('#home-tab').text("Go back");
        $('#home-tab').css('display','block');
      }
  }
  function convertMinutes(i)
  {
    var ampm=i.split(" ");
    var all = ampm[0].split(":");
    if(ampm[1]=='PM')
    {
      if(Number(all[0])=='12')
      {
          return (12 * 60) + Number(all[1]);
      }
      return (12* 60 ) +(Number(all[0]) * 60) + Number(all[1]);
    }
    else if(ampm[1]=='AM')
    {
      if(all[0]=='12')
      {
          return (0 * 60) + Number(all[1]);
      }
      return (Number(all[0]) * 60) + Number(all[1]);
    }
  }
  function timeSelect(){
timesselected=true;
    {% for bike in bike_type %}
        bike[Number({{ bike.bike_type_id }})-1]=Number($('#quantity{{ bike.bike_type_id }}').text());
      {% endfor %}
    var total = 0;
    {% for bike in bike_type %}
          total = total+bike[Number({{ bike.bike_type_id }})-1];
      {% endfor %}
    if((total)>0)
    {
          bikesselected=true;
    }
    if(bikesselected==true && timesselected==true)
    {
      confirmed();
      return;
    //  alert("Done1");
    }
    repeat=true;
    document.getElementById("home-tab").click();
  }
  function bikeSelect() {
  startTime=document.getElementById("select_start_time").options[document.getElementById("select_start_time").selectedIndex].value;
  endTime=document.getElementById("select_end_time").options[document.getElementById("select_end_time").selectedIndex].value;
  startDate=document.getElementById("select_start_date").options[document.getElementById("select_start_date").selectedIndex].value;
  endDate=document.getElementById("select_end_date").options[document.getElementById("select_end_date").selectedIndex].value;

  $('#startinfo').text('Start: '+ startDate+' '+minutesToString(startTime));
  $('#endinfo').text('End: '+ endDate+' '+minutesToString(endTime));
  //timesselected=true;
  //  if(bikesselected==true && timesselected==true)
  //  {
  //    confirmed();
    //  alert('Done2');
  //  }
  }
  //--------------------------------------------------------------------
      function populateDate(selector,text,days,curr)
      {
        var x;
        //book today too unless its 11
        if((curr.getMinutes()+(curr.getHours()*60))>= (1440-60-15) && selector=='#select_start_date')
        {
            x=1;
            days=days+1;
        }
        else if(selector=='#select_end_date' && curr.toDateString() == new Date().toDateString())
        {
          var dates= new Date();
          if((dates.getMinutes()+(dates.getHours()*60))< (1440-60-15)  && (dates.getMinutes()+(dates.getHours()*60))>= (1440-60-15-15))
          {x=1;}
          else{x=0;}
        }
        else
          x=0;
        var options = "";
        var first = curr.getDate();
        var firstday = (new Date(curr.setDate(first))).toString();
        $(selector).empty().append('<option disabled selected value>' +text+ '</option>');
        for (var i = x; i < days; i++) {
            var next = new Date(curr.getTime());
            next.setDate(first + i);
            $(selector).append('<option>' + formatDate((next.toString())) + '</option>');
        }
      }
  //--------------------------------------------------------------------
      //https://stackoverflow.com/questions/8918168/javascript-dynamic-time-drop-down
      function populate(selector,text,x,y) {
        //select all times from all dates that are not full
        var select = $(selector);
        var hours, minutes, ampm;
        select.empty().append($('<option disabled selected value>'+text+'</option>'));
        for(var i = x; i <= y; i += 15){
            hours = Math.floor(i / 60);
            minutes = i % 60;
            if (minutes < 10){
                minutes = '0' + minutes; // adding leading zero
              }
            ampm = hours % 24 < 12 ? 'AM' : 'PM';
            hours = hours % 12;
            if (hours == 0){
                hours = 12;
              }
            select.append($('<option></option>')
            .attr('value', i)
            .text(hours + ':' + minutes + ' ' + ampm));
      }
      }


  //--------------------------------------------------------------------
      $('#select_start_date').change(function() {
      var parts = $(this).val().split(' ');
      dateselected=new Date(parts[2],monthNames.indexOf(parts[1]),parts[0]);
      populateDate("#select_end_date",'Select End date',2,dateselected);
      enable("select_end_date");
      disable("select_end_time");
      disable("select_start_time");
      $("#totalcost").text($("#totalcost").text()-(Number($("#cost").text())));
      $("#cost").text("0");
      document.getElementById("confirm").style.display="none";
      });

  //--------------------------------------------------------------------
      $('#select_end_date').change(function() {
       disable("select_end_time");
       enable("select_start_time");
       var parts = $(this).val().split(' ');
       dateselected=new Date(parts[2],monthNames.indexOf(parts[1]),parts[0]);
       var start=document.getElementById("select_start_date").options[document.getElementById("select_start_date").selectedIndex].value.split(' ');
       var st=new Date(start[2],monthNames.indexOf(start[1]),start[0]);
       var end=document.getElementById("select_end_date").options[document.getElementById("select_end_date").selectedIndex].value.split(' ');
       var en=new Date(end[2],monthNames.indexOf(end[1]),end[0]);
       if(st.toDateString() == new Date().toDateString() && en.toDateString() != new Date().toDateString())
       {
         var dates = new Date();
         if(st.getDate()==(dates.getDate()+1) && (dates.getMinutes()+(dates.getHours()*60)) >= 1380)
           populate('#select_start_time','Select Start time',(((new Date().getMinutes()) + ((15 - ((new Date().getMinutes()) % 15))) % 15))+((new Date().getHours())*60)+60-1440,1425);
         else
          populate('#select_start_time','Select Start time',(((new Date().getMinutes()) + ((15 - ((new Date().getMinutes()) % 15))) % 15))+((new Date().getHours())*60)+60,1425);
       }
       else if(st.toDateString() == new Date().toDateString() && en.toDateString() == new Date().toDateString())
       {
         var dates = new Date();
         if(st.getDate()==(dates.getDate()+1) && (dates.getMinutes()+(dates.getHours()*60)) >= 1380)
           populate('#select_start_time','Select Start time',(((new Date().getMinutes()) + ((15 - ((new Date().getMinutes()) % 15))) % 15))+((new Date().getHours())*60)+60-1440,1425);
         else
          populate('#select_start_time','Select Start time',(((new Date().getMinutes()) + ((15 - ((new Date().getMinutes()) % 15))) % 15))+((new Date().getHours())*60)+60,1410);
       }
       else {
         var dates = new Date();
         if(st.getDate()==(dates.getDate()+1) && (dates.getMinutes()+(dates.getHours()*60)) >= 1380)
           populate('#select_start_time','Select Start time',(((new Date().getMinutes()) + ((15 - ((new Date().getMinutes()) % 15))) % 15))+((new Date().getHours())*60)+60-1440,1425);
         else
          populate('#select_start_time','Select Start time',0,1425);
       }
       $("#totalcost").text($("#totalcost").text()-(Number($("#cost").text())));
       $("#cost").text("0");
       document.getElementById("confirm").style.display="none";
      });

  //--------------------------------------------------------------------
      $('#select_start_time').change(function() {
      enable("select_end_time");
      var start=document.getElementById("select_start_date").options[document.getElementById("select_start_date").selectedIndex].value.split(' ');
      var st=new Date(start[2],monthNames.indexOf(start[1]),start[0]);
      var end=document.getElementById("select_end_date").options[document.getElementById("select_end_date").selectedIndex].value.split(' ');
      var en=new Date(end[2],monthNames.indexOf(end[1]),end[0]);
      if(st.toDateString() == en.toDateString())
      {
        populate('#select_end_time','Select End time',Number($(this).val())+15,1425);
      }
      else {
        populate('#select_end_time','Select End time',0,Number($(this).val()));
      }
      $("#totalcost").text($("#totalcost").text()-(Number($("#cost").text())));
        $("#cost").text("0");
      document.getElementById("confirm").style.display="none";
      });

  //--------------------------------------------------------------------
      $('#select_end_time').change(function() {
            document.getElementById("confirm").style.display="block";
            var cost=0;
            var costperfifteen={{ costperhour }}/4;
            startTime=document.getElementById("select_start_time").options[document.getElementById("select_start_time").selectedIndex].value;
            endTime=document.getElementById("select_end_time").options[document.getElementById("select_end_time").selectedIndex].value;
            startDate=document.getElementById("select_start_date").options[document.getElementById("select_start_date").selectedIndex].value;
            endDate=document.getElementById("select_end_date").options[document.getElementById("select_end_date").selectedIndex].value;
            if(startDate==endDate)
            {
                for(var i = Number(startTime); i < Number(endTime); i += 15){
                  cost=costperfifteen+cost;
            }
            }
            else {
              for(var i = Number(startTime); i < 1440; i += 15){
                  cost=costperfifteen+cost;
                }
            for(var i = 0; i < Number(endTime); i += 15){
                cost=costperfifteen+cost;
              }
            }
            $('#cost').text(Number(cost));
            $('#totalcost').text(Number(cost)+Number($('#cyclecost').text()));
      });

  //--------------------------------------------------------------------
  $(document).ready(function(){
 setInterval(function(){ reload_page(); },60*60000);
  });

  function reload_page()
  {
    window.location.reload(true);
  }
  $(function() {


  // This function gets cookie with a given name
  function getCookie(name) {
      var cookieValue = null;
      if (document.cookie && document.cookie != '') {
          var cookies = document.cookie.split(';');
          for (var i = 0; i < cookies.length; i++) {
              var cookie = jQuery.trim(cookies[i]);
              // Does this cookie string begin with the name we want?
              if (cookie.substring(0, name.length + 1) == (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
  }
  var csrftoken = getCookie('csrftoken');

  /*
  The functions below will create a header with csrftoken
  */

  function csrfSafeMethod(method) {
      // these HTTP methods do not require CSRF protection
      return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }
  function sameOrigin(url) {
      // test that a given url is a same-origin URL
      // url could be relative or scheme relative or absolute
      var host = document.location.host; // host + port
      var protocol = document.location.protocol;
      var sr_origin = '//' + host;
      var origin = protocol + sr_origin;
      // Allow absolute or scheme relative URLs to same origin
      return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
          (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
          // or any other URL that isn't scheme relative or absolute i.e relative.
          !(/^(\/\/|http:|https:).*/.test(url));
  }

  $.ajaxSetup({
      beforeSend: function(xhr, settings) {
          if (!csrfSafeMethod(settings.type) && sameOrigin(settings.url)) {
              // Send the token to same-origin, relative URLs only.
              // Send the token only if the method warrants CSRF protection
              // Using the CSRFToken value acquired earlier
              xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
      }
  });

});
  $('#timeform').on('submit', function(event){
  event.preventDefault();
  time_post();
});
// AJAX for posting
function time_post() {
$.ajax({
      url : "/home/reserve/", // the endpoint
      type : "POST", // http method
      data : { formtype : 'time', starttime:minutesToString(startTime) , endtime: minutesToString(endTime), startdate: startDate, enddate: endDate,startstation: $('#startloc').text(),endstation:$('#endloc').text()}, // data sent with the post request

      // handle a successful response
      success : function(json) {
    //     if (
    //     //this part checks if all the available bikes added together ==0 if yes then returns 0
    //     {% for bike in bike_type %}
    //     json.result{{ bike.bike_type_id }} +
    //   {% endfor %}0 == 0)
    //   {
    //     alert("Sorry, there are no bikes available for that timing, try again");
    //   bru=false;
    //   document.getElementById('clickme').click();
    // //  reload_page();
    //   }
      //This else loop sets the available bikes for each of the bike types
      // else{
      if (
            //this part checks if all the available bikes added together ==0 if yes then returns 0
          {% for bike in bike_type %}
            json.result{{ bike.bike_type_id }} +
          {% endfor %}0 == 0)
          {
            alert("Sorry, there are no bikes available for that timing, but you surely can remove chosen bikes!");
          }
        {% for bike in bike_type %}
        $('#available{{ bike.bike_type_id }}').text(json.result{{ bike.bike_type_id }}); // remove the value from the input
      {% endfor %}
      document.getElementById("profile-tab").click();
    // }
      },

      // handle a non-successful response
      error : function(xhr,errmsg,err) {
              }
  });
};

$('#bikeform').on('submit', function(event){
event.preventDefault();
bike_post();
});
// AJAX for posting
function bike_post() {
$.ajax({
  url : "/home/reserve/", // the endpoint
  type : "POST", // http method
  data : { formtype: 'bike', bikes: bike}, // data sent with the post fo
  // handle a successful response
  success : function(json) {
      $('#post-text').val(json.result); // remove the value from the input
  },

  // handle a non-successful response
  error : function(xhr,errmsg,err) {
          }
});
};
//-------------------------------------
// AJAX for posting
function cancel_reser() {
$.ajax({
  url : "/home/reservations/", // the endpoint
  type : "POST", // http method
  data : { formtype: 'cancel', reservationcode:cancelreser}, // data sent with the post fo
  // handle a successful response
  success : function(json) {
    //IF ELSE LOOP IF NO TIME THEN DISPLAY ERROR AND CLICK CANCEL BUTTON
    //IF THERE ARE NO TIMES AVAILABLE THEN :
    //alert('Sorry, there are no other times you can change, other reservations occupied')
    //document.getElementById('pleaseclose').click();
        alert('Your refund of '+json[0]+' will be processed, check your mail for updates'); // remove t // remove the value from the input
        reload_page();
  },

  // handle a non-successful response
  error : function(xhr,errmsg,err) {
          }
});
};
function fine_reser() {
$.ajax({
  url : "/home/reservations/", // the endpoint
  type : "POST", // http method
  data : { formtype: 'fine', reservationcode:payfinereser,finecost: $('#finecost').text()}, // data sent with the post fo
  // handle a successful response
  success : function(json) {
    //IF ELSE LOOP IF NO TIME THEN DISPLAY ERROR AND CLICK CANCEL BUTTON
    //IF THERE ARE NO TIMES AVAILABLE THEN :
    //alert('Sorry, there are no other times you can change, other reservations occupied')
    //document.getElementById('pleaseclose').click();
        alert('Thank you for paying your fine!'); // remove t // remove the value from the input
        reload_page();
  },

  // handle a non-successful response
  error : function(xhr,errmsg,err) {
          }
});
};
function feedback_reser() {
$.ajax({
  url : "/home/reservations/", // the endpoint
  type : "POST", // http method
  data : { formtype: 'feedback', reservationcode:feedbackreservation,feedback:feedbacktext,rating:ratingnumber}, // data sent with the post fo
  // handle a successful response
  success : function(json) {
    alert('Feedback Sent');
    reload_page();
    //IF ELSE LOOP IF NO TIME THEN DISPLAY ERROR AND CLICK CANCEL BUTTON
    //IF THERE ARE NO TIMES AVAILABLE THEN :
    //alert('Sorry, there are no other times you can change, other reservations occupied')
    //document.getElementById('pleaseclose').click();

  },

  // handle a non-successful response
  error : function(xhr,errmsg,err) {
          }
});
};

function report_reser() {


$.ajax({
  url : "/home/reservations/", // the endpoint
  type : "POST", // http method
  data : { formtype: 'feedback', reservationcode:reportreser,feedback:report,rating:1}, // data sent with the post fo
  // handle a successful response
  success : function(json) {
    alert('Sorry for the inconvenience...You will be assisted right away!');
    reload_page();

    //IF ELSE LOOP IF NO TIME THEN DISPLAY ERROR AND CLICK CANCEL BUTTON
    //IF THERE ARE NO TIMES AVAILABLE THEN :
    //alert('Sorry, there are no other times you can change, other reservations occupied')
    //document.getElementById('pleaseclose').click();

  },

  // handle a non-successful response
  error : function(xhr,errmsg,err) {
          }
});
};
//------------------------------------------
  </script>
 <!-- Information model -->
  <div class="modal" id="myInformationModal">
    <div class="modal-dialog">
      <div class="modal-content contented" >
        <div class="modal-header" style="border-bottom: 0px; padding-bottom: 0px;">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="centered_item" style=" margin-bottom: 2%; margin-top: 0px;" >
          <div class="modal-body "  style=" height: 50%; min-height: 100px;  width: 90%; margin-top: 0px;">
            <h3 style="color:white; "> Changes have been made!</h3>
            <h3 style="color:white;"> Thank you for using our service! </h3>
            <button type="button" data-dismiss="modal" class="btn btn-success" style="width: 100%;">Okay!</button>
            <div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
 <!-- The Cancelation Modal -->
   <div class="modal" id="myCancelationModal" >
    <div class="modal-dialog">
      <div class="modal-content contented" style=" background-color: lightgrey; ">
        <div class="modal-header"  style="border-bottom: 0px; padding-bottom: 0px;">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body" >
            <h4 class="centered_item"  style="color:#3d3a3a; margin-top: 2%; margin-bottom: 5%; width:100%;">Are you sure you want to cancel your reservation? </h4>
            <button type="button" id="cancelReservation" data-dismiss="modal" style="width: 100%; color:white;" class="btn btn-success centered_item" onclick="cancelReservation(this);" >Yes</button>
            <button type="button" data-dismiss="modal" style="width: 100%;color:white;" class="btn btn-danger centered_item">No</button>
        </div>
      </div>
    </div>
   </div>
   <!-- The Fine Modal -->
   <div class="modal" id="myFineModal">
    <div class="modal-dialog" >
      <div class="modal-content contented" style=" background-color: lightgrey; ">
        <div class="modal-header"  style="border-bottom: 0px; padding-bottom: 0px;">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body" >
            <h4 class="centered_item"  style="color:#3d3a3a; margin-top: 2%; margin-bottom: 5%; width:100%;">Are you sure you want to pay a fine of? &nbsp; <span id='finecost'></span></h4>
            <h4 class="centered_item"  style="color:#3d3a3a; margin-top: 2%; margin-bottom: 5%; width:100%;">Fine description: &nbsp; <span id='finereason'></span></h4>
            <button type="button" id="payReservation" data-dismiss="modal" style="width: 100%; color:white;" class="btn btn-success centered_item" onclick="payReservation(this);" >Yes</button>
            <button type="button" data-dismiss="modal" style="width: 100%;color:white;" class="btn btn-danger centered_item">No</button>
        </div>
      </div>
    </div>
   </div>
   <!-- The Report Modal -->
   <div class="modal" id="myReportModal">
     <div class="modal-dialog">
       <div class="modal-content" >
         <div class="modal-header" style="background-color:lightgrey; border-bottom: 0px; margin-bottom: 0px; padding-bottom: 0px;">
           <button type="button" class="close" data-dismiss="modal">&times;</button>
         </div>
         <div class="centered_item" style=" margin-bottom: 2%;background-color:lightgrey;" >
           <div class="modal-body "  style="background-color:lightgrey;height: 50%; min-height: 100px;  width: 90%; margin-top: 0px;">
             <h2 style="color: #3d3a3a; font-size: 29px;">Are you having an issue on this reservation? <br><span style="color: #3dcacd">Sorry for the inconvenience!</span></h2>
             <h4 style="color: #3d3a3a; ">  Report your issue here, be specific about what has happened so an action can be taken!</h3>
            <div class="input-group " style="width:100%; margin-top:5%;margin-bottom: 3%;">
                 <form>
                  <textarea class="form-control" id="customerreport" aria-label="With textarea" placeholder="Report an issue" style=" margin-bottom: 1%;" required></textarea>
                  <p id="desc"></p>
                  <input style='width: 100%;' class="btn btn-success" type='submit' id="myBtnSubmitReport" value='Submit' onclick='sendReport(this)'/>
                 </form>
             </div>
             <div>
             </div>
           </div>
         </div>
       </div>
     </div>
   </div>
   <!-- The Edit Modal -->
   <div class="modal" id="myEditModal">
    <div class="modal-dialog">
      <div class="modal-content contented">
        <div class="modal-header" style="border-bottom: 0px; padding-bottom: 0px;">
          <button type="button" class="close" id='pleaseclose' data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
           <h2 style="color: rgba(0, 179, 179, 1); margin-left: 2%; font-weight: bold;">Edit reservation timing</h2>
           <form>
              <div class="form-group col-md-6" style="width:100%;">
                <h4>Current Pick up time</h4>
                <p id='currentpickuptime'></p>
                <h4>Current Drop Off time</h4>
                <p id='currentdropofftime'></p>
                <!--<h4>Time €<span id="currentcost">0</span></h4>
                <h4>Bike €<span  id="cyclecost">0</span></h4>-->
                <h4>Total €<span id="currentcost">0</span></h4>
              </div>
              <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="startTime">Change Pick up time from <span id='currentstartstation'></span></label>
                  <select class="styled-select black rounded" id="currentstarttime">
                    <option disabled selected value>Change Pick Up Time</option>
                  </select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="endTime">Change Drop off time to <span id='currentendstation'></span></label>
                  <select class="styled-select black rounded" id="currentendtime">
                    <option disabled selected value>Change Drop Off Time</option>
                  </select>
                </div>
              </div>
              <div class="form-group col-md-6" style="width:100%;">
              </div>
              <div class="form-group col-md-6" style="border-top: solid 1 px white; width: 100%;">
                <h4>You will be charged: XX$</h4>
              </div>
              <button type="submit" class="btn btn-success"  id="myBtnSubmitChanges" data-dismiss="modal" onclick="editDetails()" style="width: 100%;">Proceed</button>
            </form>
        </div>
      </div>
    </div>
  </div>
  <!---------------------------------------->
<script>
  $('#currentstarttime').change(function() {
    var select = $('#currentendtime');
    select.empty().append($('<option disabled selected value>'+'Edit Drop off time'+'</option>'));
    select.append($('<option></option>')
        .attr('value', 6)
        .text(':'+' ' ));
    select.append($('<option></option>')
            .attr('value', 5)
            .text('dfgdf:'+' ' ));
    document.getElementById('currentendtime').selectedIndex=0;
    document.getElementById('currentendtime').style.color= "black" ;
    document.getElementById('currentendtime').disabled = false;
    document.getElementById('myBtnSubmitChanges').style.display="none";
  });
  $('#currentendtime').change(function() {
    document.getElementById('myBtnSubmitChanges').style.display="block";
  });
</script>
<!------------------------------------------>
</body>
{% endblock %}
